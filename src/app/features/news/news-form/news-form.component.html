<!-- Professional News Form with Shadcn Styling & Rose Theme -->
<div class="min-h-screen bg-linear-to-br from-background via-background to-muted/30">
  <div class="mx-auto max-w-5xl px-4 py-6 sm:px-6 sm:py-8 lg:px-8 lg:py-10">

    <!-- Enhanced Header with Rose Gradient -->
    <div class="mb-6 lg:mb-8">
      <div class="overflow-hidden rounded-2xl border-2 border-rose-200/50 dark:border-rose-900/30 bg-linear-to-br from-rose-50 via-rose-100/50 to-rose-50 dark:from-rose-950/40 dark:via-rose-900/20 dark:to-rose-950/40 shadow-md">
        <div class="px-6 py-8 sm:px-8 sm:py-10">
          <div class="flex items-center gap-4 mb-4">
            <div class="flex h-16 w-16 shrink-0 items-center justify-center rounded-full bg-rose-100 dark:bg-rose-900/40 ring-2 ring-rose-200 dark:ring-rose-800">
              <span class="text-3xl">{{ isEditing() ? '‚úèÔ∏è' : 'üìù' }}</span>
            </div>
            <div>
              <h1 class="text-3xl font-bold text-rose-900 dark:text-rose-100 lg:text-4xl tracking-tight">
                {{ isEditing() ? 'Edit News Article' : 'Create News Article' }}
              </h1>
              <p class="mt-1 text-lg text-rose-700 dark:text-rose-300 font-medium">
                {{ isEditing() ? 'Update your news article information' : 'Create a new news article for your audience' }}
              </p>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Main Form -->
    <form (ngSubmit)="onSubmit()" class="space-y-6">

      <!-- Title Section -->
      <div class="rounded-2xl border-2 border-border/50 bg-card p-6 shadow-sm hover:shadow-md transition-all">
        <div class="mb-3 flex items-center justify-between">
          <label class="flex items-center gap-2 text-base font-bold text-foreground">
            <span class="text-2xl">üì∞</span>
            Article Title
            <span class="text-destructive">*</span>
          </label>
          <span class="rounded-full bg-muted px-3 py-1 text-xs font-semibold text-muted-foreground">
            {{ getTitleCharCount() }}/{{ TITLE_MAX_LENGTH }}
          </span>
        </div>
        <input
          type="text"
          [value]="formData().title"
          (input)="updateField('title', $any($event.target).value)"
          [attr.maxlength]="TITLE_MAX_LENGTH"
          name="title"
          class="w-full rounded-xl border-2 border-border/50 bg-background px-4 py-3 text-base text-foreground placeholder:text-muted-foreground focus:border-rose-500 focus:outline-none focus:ring-2 focus:ring-rose-500/20 transition-all"
          placeholder="Enter a compelling news title..."
          required
        />
        <p class="mt-2 text-sm text-muted-foreground">A clear and engaging title that captures attention</p>
      </div>

      <!-- Category, Status, and Featured Row -->
      <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3">
        <!-- Category -->
        <div class="rounded-2xl border-2 border-border/50 bg-card p-6 shadow-sm hover:shadow-md transition-all">
          <label class="mb-3 flex items-center gap-2 text-base font-bold text-foreground">
            <span class="text-2xl">üè∑Ô∏è</span>
            Category
          </label>
          <ng-select
            [ngModel]="formData().category"
            (ngModelChange)="updateField('category', $event)"
            [items]="categoryOptions"
            bindLabel="label"
            bindValue="value"
            [clearable]="true"
            placeholder="Select category"
            class="custom-ng-select"
            name="category"
            [ngModelOptions]="{standalone: true}"
          />
        </div>

        <!-- Status -->
        <div class="rounded-2xl border-2 border-border/50 bg-card p-6 shadow-sm hover:shadow-md transition-all">
          <label class="mb-3 flex items-center gap-2 text-base font-bold text-foreground">
            <span class="text-2xl">üìä</span>
            Status
            <span class="text-destructive">*</span>
          </label>
          <ng-select
            [ngModel]="formData().status"
            (ngModelChange)="updateField('status', $event)"
            [items]="statusOptions"
            bindLabel="label"
            bindValue="value"
            [clearable]="false"
            placeholder="Select status"
            class="custom-ng-select"
            name="status"
            [ngModelOptions]="{standalone: true}"
          />
        </div>

        <!-- Featured Toggle -->
        <div class="rounded-2xl border-2 border-border/50 bg-card p-6 shadow-sm hover:shadow-md transition-all">
          <label class="mb-3 flex items-center gap-2 text-base font-bold text-foreground">
            <span class="text-2xl">‚≠ê</span>
            Featured
          </label>
          <label class="flex items-center gap-3 cursor-pointer group">
            <div class="relative">
              <input
                type="checkbox"
                [checked]="formData().featured"
                (change)="updateField('featured', $any($event.target).checked)"
                name="featured"
                class="peer h-6 w-6 cursor-pointer appearance-none rounded-lg border-2 border-border/50 bg-background transition-all checked:border-rose-600 checked:bg-rose-600 focus:ring-2 focus:ring-rose-500/20"
              />
              <svg class="absolute left-1 top-1 h-4 w-4 text-white opacity-0 peer-checked:opacity-100 transition-opacity pointer-events-none" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="3" d="M5 13l4 4L19 7"/>
              </svg>
            </div>
            <div class="flex-1">
              <span class="text-sm font-semibold text-foreground group-hover:text-rose-600 transition-colors">Make this featured</span>
              <p class="text-xs text-muted-foreground">Display prominently</p>
            </div>
          </label>
        </div>
      </div>

      <!-- Featured Image Upload -->
      <div class="rounded-2xl border-2 border-border/50 bg-card p-6 shadow-sm hover:shadow-md transition-all">
        <label class="mb-4 flex items-center gap-2 text-base font-bold text-foreground">
          <span class="text-2xl">üñºÔ∏è</span>
          Featured Image
        </label>
        <app-image-upload
          [imageUrl]="formData().image_url"
          (imageUrlChange)="updateField('image_url', $event)"
          name="image_url"
        />
        <p class="mt-3 text-sm text-muted-foreground">Upload a high-quality image that represents your news article</p>
      </div>

      <!-- Excerpt -->
      <div class="rounded-2xl border-2 border-border/50 bg-card p-6 shadow-sm hover:shadow-md transition-all">
        <div class="mb-3 flex items-center justify-between">
          <label class="flex items-center gap-2 text-base font-bold text-foreground">
            <span class="text-2xl">üìã</span>
            Excerpt
          </label>
          <span class="rounded-full bg-muted px-3 py-1 text-xs font-semibold text-muted-foreground">
            {{ getExcerptCharCount() }}/{{ EXCERPT_MAX_LENGTH }}
          </span>
        </div>
        <textarea
          [value]="formData().excerpt"
          (input)="updateField('excerpt', $any($event.target).value)"
          [attr.maxlength]="EXCERPT_MAX_LENGTH"
          rows="3"
          name="excerpt"
          class="w-full rounded-xl border-2 border-border/50 bg-background px-4 py-3 text-base text-foreground placeholder:text-muted-foreground focus:border-rose-500 focus:outline-none focus:ring-2 focus:ring-rose-500/20 transition-all resize-none"
          placeholder="Write a brief summary that will appear in previews..."
        ></textarea>
        <p class="mt-2 text-sm text-muted-foreground">A compelling summary that encourages readers to click and read more</p>
      </div>

      <!-- Content -->
      <div class="rounded-2xl border-2 border-border/50 bg-card p-6 shadow-sm hover:shadow-md transition-all">
        <div class="mb-3 flex items-center justify-between">
          <label class="flex items-center gap-2 text-base font-bold text-foreground">
            <span class="text-2xl">üìù</span>
            Article Content
            <span class="text-destructive">*</span>
          </label>
          <span class="rounded-full bg-muted px-3 py-1 text-xs font-semibold text-muted-foreground">
            {{ getContentCharCount() }}/{{ CONTENT_MAX_LENGTH }}
          </span>
        </div>
        <textarea
          name="content"
          [value]="formData().content"
          (input)="updateField('content', $any($event.target).value)"
          [attr.maxlength]="CONTENT_MAX_LENGTH"
          rows="16"
          class="w-full rounded-xl border-2 border-border/50 bg-background px-4 py-3 font-mono text-sm text-foreground placeholder:text-muted-foreground focus:border-rose-500 focus:outline-none focus:ring-2 focus:ring-rose-500/20 transition-all resize-y"
          placeholder="Write your complete news article here...&#10;&#10;You can format your content with paragraphs and sections for better readability."
          required
        ></textarea>
        <p class="mt-2 text-sm text-muted-foreground">Write engaging, informative content that provides value to your readers</p>
      </div>

      <!-- Target Audience Section -->
      <div class="rounded-2xl border-2 border-rose-200/50 dark:border-rose-900/30 bg-linear-to-br from-rose-50/30 via-card to-card dark:from-rose-950/10 dark:via-card dark:to-card p-6 shadow-sm hover:shadow-md transition-all">
        <div class="mb-6">
          <h2 class="flex items-center gap-3 text-xl font-bold text-foreground mb-2">
            <span class="text-3xl">üéØ</span>
            Target Audience
          </h2>
          <p class="text-base text-muted-foreground">
            Select who should see this news article. Leave all unselected to show to everyone.
          </p>
        </div>

        <div class="grid gap-6 sm:grid-cols-2">
          <!-- Regions -->
          @if (canSelectRegions()) {
            <div class="rounded-xl border-2 border-border/50 bg-card p-5">
              <label class="mb-4 flex items-center gap-2 text-base font-bold text-foreground">
                <span class="text-xl">üó∫Ô∏è</span>
                Regions
              </label>
              <ng-select
                [ngModel]="formData().region_ids"
                (ngModelChange)="updateField('region_ids', $event)"
                [items]="regions()"
                bindLabel="name"
                bindValue="id"
                [multiple]="true"
                [closeOnSelect]="false"
                [clearable]="true"
                placeholder="Select regions"
                class="custom-ng-select"
                name="region_ids"
                [ngModelOptions]="{standalone: true}"
              >
                <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                  @for (item of items; track item.id) {
                    <div class="ng-value">
                      <span class="ng-value-label">{{ item.name }}</span>
                      <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">√ó</span>
                    </div>
                  }
                </ng-template>
              </ng-select>
              <p class="mt-2 text-sm text-muted-foreground">Target specific regions</p>
            </div>
          }

          <!-- Zones -->
          @if (canSelectZones()) {
            <div class="rounded-xl border-2 border-border/50 bg-card p-5">
              <label class="mb-4 flex items-center gap-2 text-base font-bold text-foreground">
                <span class="text-xl">üìç</span>
                Zones
              </label>
              <ng-select
                [ngModel]="formData().zone_ids"
                (ngModelChange)="updateField('zone_ids', $event)"
                [items]="zones()"
                bindLabel="name"
                bindValue="id"
                [multiple]="true"
                [closeOnSelect]="false"
                [clearable]="true"
                placeholder="Select zones"
                class="custom-ng-select"
                name="zone_ids"
                [ngModelOptions]="{standalone: true}"
              >
                <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                  @for (item of items; track item.id) {
                    <div class="ng-value">
                      <span class="ng-value-label">{{ item.name }}</span>
                      <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">√ó</span>
                    </div>
                  }
                </ng-template>
              </ng-select>
              <p class="mt-2 text-sm text-muted-foreground">Target specific zones</p>
            </div>
          }

          <!-- Groups -->
          @if (canSelectGroups()) {
            <div class="rounded-xl border-2 border-border/50 bg-card p-5">
              <label class="mb-4 flex items-center gap-2 text-base font-bold text-foreground">
                <span class="text-xl">üë•</span>
                Groups
              </label>
              <ng-select
                [ngModel]="formData().group_ids"
                (ngModelChange)="updateField('group_ids', $event)"
                [items]="groups()"
                bindLabel="name"
                bindValue="id"
                [multiple]="true"
                [closeOnSelect]="false"
                [clearable]="true"
                placeholder="Select groups"
                class="custom-ng-select"
                name="group_ids"
                [ngModelOptions]="{standalone: true}"
              >
                <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                  @for (item of items; track item.id) {
                    <div class="ng-value">
                      <span class="ng-value-label">{{ item.name }}</span>
                      <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">√ó</span>
                    </div>
                  }
                </ng-template>
              </ng-select>
              <p class="mt-2 text-sm text-muted-foreground">Target specific groups</p>
            </div>
          }

          <!-- Schools -->
          @if (canSelectSchools()) {
            <div class="rounded-xl border-2 border-border/50 bg-card p-5">
              <label class="mb-4 flex items-center gap-2 text-base font-bold text-foreground">
                <span class="text-xl">üè´</span>
                Schools
              </label>
              <ng-select
                [ngModel]="formData().school_ids"
                (ngModelChange)="updateField('school_ids', $event)"
                [items]="schools()"
                bindLabel="name"
                bindValue="id"
                [multiple]="true"
                [closeOnSelect]="false"
                [clearable]="true"
                placeholder="Select schools"
                class="custom-ng-select"
                name="school_ids"
                [ngModelOptions]="{standalone: true}"
              >
                <ng-template ng-multi-label-tmp let-items="items" let-clear="clear">
                  @for (item of items; track item.id) {
                    <div class="ng-value">
                      <span class="ng-value-label">{{ item.name }}</span>
                      <span class="ng-value-icon right" (click)="clear(item)" aria-hidden="true">√ó</span>
                    </div>
                  }
                </ng-template>
              </ng-select>
              <p class="mt-2 text-sm text-muted-foreground">Target specific schools</p>
            </div>
          }
        </div>
      </div>

      <!-- Action Buttons -->
      <div class="sticky bottom-0 z-10 rounded-2xl border-2 border-border/50 bg-card/95 backdrop-blur-sm p-6 shadow-md">
        <div class="flex flex-col gap-3 sm:flex-row sm:justify-end">
          <button
            type="button"
            (click)="cancel()"
            [disabled]="loading()"
            class="order-2 sm:order-1 flex items-center justify-center gap-2 rounded-xl border-2 border-border/50 bg-background px-8 py-3.5 text-base font-bold text-foreground transition-all hover:bg-muted hover:border-border disabled:opacity-50 disabled:cursor-not-allowed shadow-sm hover:shadow-md"
          >
            <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
            Cancel
          </button>

          <button
            type="submit"
            [disabled]="loading()"
            class="order-1 sm:order-2 flex items-center justify-center gap-2 rounded-xl bg-rose-600 px-8 py-3.5 text-base font-bold text-white transition-all hover:bg-rose-700 disabled:opacity-50 disabled:cursor-not-allowed shadow-lg shadow-rose-600/20 hover:shadow-md hover:shadow-rose-600/30"
          >
            @if (loading()) {
              <svg class="h-5 w-5 animate-spin" fill="none" viewBox="0 0 24 24">
                <circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle>
                <path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path>
              </svg>
              {{ isEditing() ? 'Updating...' : 'Creating...' }}
            } @else {
              <svg class="h-5 w-5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7"/>
              </svg>
              {{ isEditing() ? 'Update News' : 'Create News' }}
            }
          </button>
        </div>
      </div>
    </form>
  </div>
</div>
